<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Security Test - Missing Headers</title>
    
    <!-- SECURITY TEST FILE - MEDIUM-RISK VIOLATIONS -->
    <!-- This file contains intentional security violations for testing Security Agent detection -->
    
    <!-- Medium-risk violations - missing security headers -->
    <!-- Missing X-Frame-Options header -->
    <!-- Missing X-Content-Type-Options header -->
    <!-- Missing X-XSS-Protection header -->
    <!-- Missing Strict-Transport-Security header -->
    <!-- Missing Content-Security-Policy header -->
    <!-- Missing Referrer-Policy header -->
    <!-- Missing Feature-Policy header -->
    
    <!-- Insecure inline styles (CSP violation) -->
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f0f0f0;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }
        .warning {
            color: red;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Security Test Page - Missing Security Headers</h1>
        
        <h2>Missing Security Headers Test</h2>
        <p class="warning">This page is missing critical security headers:</p>
        
        <ul>
            <li>X-Frame-Options: Missing (allows clickjacking)</li>
            <li>X-Content-Type-Options: Missing (allows MIME sniffing)</li>
            <li>X-XSS-Protection: Missing (no XSS protection)</li>
            <li>Strict-Transport-Security: Missing (no HSTS)</li>
            <li>Content-Security-Policy: Missing (no CSP)</li>
            <li>Referrer-Policy: Missing (referrer leakage)</li>
            <li>Feature-Policy: Missing (no feature restrictions)</li>
        </ul>
        
        <h2>Insecure Content Examples</h2>
        
        <!-- Inline JavaScript (CSP violation) -->
        <script>
            console.log('Inline JavaScript - CSP violation');
            
            // Potentially dangerous eval usage
            var userInput = "alert('XSS')";
            // eval(userInput); // Commented out to prevent actual execution
            
            // Insecure random number generation
            var insecureRandom = Math.random();
            
            // Local storage of sensitive data
            localStorage.setItem('apiKey', 'sk-1234567890abcdef');
            localStorage.setItem('userPassword', 'password123');
            
            // Insecure cookie setting
            document.cookie = "sessionId=abc123; path=/";
            document.cookie = "isAdmin=true; path=/";
            
            // Insecure AJAX request
            fetch('http://api.example.com/data', {
                method: 'GET',
                credentials: 'include'
            });
        </script>
        
        <!-- Mixed content - HTTP resource on HTTPS page -->
        <img src="http://example.com/image.jpg" alt="Insecure image">
        
        <!-- External script from untrusted source -->
        <script src="http://untrusted-cdn.com/script.js"></script>
        
        <!-- Form without CSRF protection -->
        <form method="POST" action="/submit">
            <input type="text" name="username" placeholder="Username">
            <input type="password" name="password" placeholder="Password">
            <input type="submit" value="Submit">
            <!-- Missing CSRF token -->
        </form>
        
        <!-- Iframe without restrictions -->
        <iframe src="http://example.com/content" width="600" height="400"></iframe>
        
        <!-- Links without rel="noopener" -->
        <a href="http://external-site.com" target="_blank">External Link</a>
        
        <!-- Autocomplete on sensitive fields -->
        <input type="password" name="current-password" autocomplete="current-password">
        <input type="text" name="credit-card" autocomplete="cc-number">
        
        <!-- Insecure data attributes -->
        <div data-api-key="sk-1234567890abcdef" data-user-id="123">
            User Data
        </div>
    </div>
    
    <!-- Inline event handlers (CSP violation) -->
    <button onclick="alert('Inline event handler')">Click Me</button>
    
    <!-- JavaScript protocol (security risk) -->
    <a href="javascript:alert('JavaScript protocol')">JavaScript Link</a>
    
    <!-- Data URI with executable content -->
    <iframe src="data:text/html,<script>alert('Data URI XSS')</script>"></iframe>
    
    <!-- Server information disclosure in comments -->
    <!-- Server: Apache/2.4.41 (Ubuntu) -->
    <!-- PHP Version: 7.4.3 -->
    <!-- Database: MySQL 8.0.25 -->
    <!-- Framework: Laravel 8.x -->
    
    <!-- Additional inline JavaScript -->
    <script>
        // Insecure postMessage usage
        window.addEventListener('message', function(event) {
            // No origin validation
            document.getElementById('content').innerHTML = event.data;
        });
        
        // Insecure WebSocket connection
        var ws = new WebSocket('ws://localhost:8080');
        
        // Insecure geolocation request
        navigator.geolocation.getCurrentPosition(function(position) {
            console.log('Location: ' + position.coords.latitude + ', ' + position.coords.longitude);
        });
        
        // Insecure camera/microphone access
        navigator.mediaDevices.getUserMedia({ video: true, audio: true })
            .then(function(stream) {
                console.log('Media access granted');
            });
        
        // Insecure notification permission
        Notification.requestPermission().then(function(permission) {
            if (permission === 'granted') {
                new Notification('Insecure notification');
            }
        });
    </script>
</body>
</html>